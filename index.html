function togglePlay() {
            const playBtn = document.getElementById('playBtn');
            
            if (isPlaying) {
                audioPlayer.pause();<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R√°dio Supermercado do Louro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        body.dark {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 500px;
            text-align: center;
            transition: all 0.3s ease;
        }

        body.dark .container {
            background: rgba(30, 30, 50, 0.95);
            color: white;
        }

        .logo {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        body.dark .subtitle {
            color: #ccc;
        }

        .album-cover {
            width: 200px;
            height: 200px;
            margin: 20px auto;
            border-radius: 15px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease;
        }

        .album-cover:hover {
            transform: scale(1.05);
        }

        .album-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 15px;
        }

        .now-playing {
            margin: 20px 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        body.dark .now-playing {
            background: rgba(255, 255, 255, 0.1);
        }

        .track-title {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .track-info {
            color: #666;
            font-size: 0.9em;
        }

        body.dark .track-info {
            color: #ccc;
        }

        .controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }

        .control-btn {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .control-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px 0;
        }

        .volume-slider {
            flex: 1;
            height: 5px;
            background: #ddd;
            border-radius: 5px;
            outline: none;
            -webkit-appearance: none;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border-radius: 50%;
            cursor: pointer;
        }

        .admin-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .admin-btn:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: scale(1.05);
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: scale(1.05);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }

        body.dark .modal-content {
            background: #1a1a2e;
            color: white;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 2em;
            cursor: pointer;
            color: #666;
        }

        body.dark .close-btn {
            color: #ccc;
        }

        .admin-section {
            margin: 20px 0;
            padding: 20px;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 10px;
        }

        body.dark .admin-section {
            background: rgba(255, 255, 255, 0.1);
        }

        .file-input {
            margin: 10px 0;
            padding: 10px;
            border: 2px dashed #ddd;
            border-radius: 10px;
            width: 100%;
        }

        .btn {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .file-list {
            max-height: 200px;
            overflow-y: auto;
            margin: 10px 0;
        }

        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 10px;
            margin: 5px 0;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 5px;
        }

        body.dark .file-item {
            background: rgba(255, 255, 255, 0.1);
        }

        .delete-btn {
            background: #ff4757;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.8em;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: rgba(0, 0, 0, 0.05);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        body.dark .stat-card {
            background: rgba(255, 255, 255, 0.1);
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #ff6b6b;
        }

        .album-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .album-option {
            background: rgba(0, 0, 0, 0.05);
            border: 2px solid transparent;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .album-option:hover {
            border-color: #4ecdc4;
            transform: translateY(-2px);
        }

        .album-option.active {
            border-color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
        }

        body.dark .album-option {
            background: rgba(255, 255, 255, 0.1);
        }

        @media (max-width: 768px) {
            .container {
                margin: 20px;
                padding: 20px;
            }
            
            .logo {
                font-size: 2em;
            }
            
            .admin-btn, .theme-toggle {
                position: relative;
                top: auto;
                left: auto;
                right: auto;
                margin: 10px;
            }
        }
    </style>
</head>
<body>
    <button class="theme-toggle" onclick="toggleTheme()">üåì Tema</button>
    <button class="admin-btn" onclick="openAdminModal()">‚öôÔ∏è Admin</button>

    <div class="container">
        <div class="logo">üéµ R√ÅDIO LOURO</div>
        <div class="subtitle">Supermercado do Louro</div>

        <div class="album-cover" id="albumCover">
            üéµ
        </div>

        <div class="now-playing">
            <div class="track-title" id="trackTitle">Carregando...</div>
            <div class="track-info" id="trackInfo">Preparando sua r√°dio...</div>
        </div>

        <div class="controls">
            <button class="control-btn" onclick="togglePlay()" id="playBtn">
                ‚ñ∂Ô∏è
            </button>
        </div>

        <div class="volume-control">
            <span>üîä</span>
            <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="70">
            <span id="volumeDisplay">70%</span>
        </div>
    </div>

    <!-- Modal Admin -->
    <div class="modal" id="adminModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeAdminModal()">&times;</button>
            <h2>üõ†Ô∏è Painel Administrativo</h2>
            
            <div id="loginSection">
                <h3>Acesso Restrito</h3>
                <input type="password" id="adminPassword" placeholder="Digite a senha" style="padding: 10px; border-radius: 5px; border: 1px solid #ddd; margin: 10px; width: 200px;">
                <button class="btn" onclick="adminLogin()">Entrar</button>
            </div>

            <div id="adminPanel" style="display: none;">
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-number" id="totalSongs">0</div>
                        <div>M√∫sicas</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalPlayed">0</div>
                        <div>Reproduzidas</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="currentAlbum">Nenhum</div>
                        <div>√Ålbum Ativo</div>
                    </div>
                </div>

                <div class="admin-section">
                    <h3>üìÅ Upload de Arquivos</h3>
                    
                    <div>
                        <h4>üéµ M√∫sicas Principais</h4>
                        <input type="file" class="file-input" id="musicUpload" accept=".mp3" multiple>
                        <button class="btn" onclick="uploadFiles('music')">Upload M√∫sicas</button>
                        <div class="file-list" id="musicList"></div>
                    </div>

                    <div>
                        <h4>üïê Hora Certa</h4>
                        <input type="file" class="file-input" id="timeUpload" accept=".mp3" multiple>
                        <button class="btn" onclick="uploadFiles('time')">Upload Hora</button>
                        <div class="file-list" id="timeList"></div>
                    </div>

                    <div>
                        <h4>üì¢ Avisos</h4>
                        <input type="file" class="file-input" id="adUpload" accept=".mp3" multiple>
                        <button class="btn" onclick="uploadFiles('ads')">Upload Avisos</button>
                        <div class="file-list" id="adsList"></div>
                    </div>
                </div>

                <div class="admin-section">
                    <h3>üé≠ √Ålbuns Tem√°ticos</h3>
                    <div class="album-selector">
                        <div class="album-option" data-album="none" onclick="selectAlbum('none')">
                            <div>‚ùå</div>
                            <div>Desativado</div>
                        </div>
                        <div class="album-option" data-album="natal" onclick="selectAlbum('natal')">
                            <div>üéÑ</div>
                            <div>Natal</div>
                        </div>
                        <div class="album-option" data-album="pascoa" onclick="selectAlbum('pascoa')">
                            <div>üê∞</div>
                            <div>P√°scoa</div>
                        </div>
                        <div class="album-option" data-album="saojoao" onclick="selectAlbum('saojoao')">
                            <div>üåΩ</div>
                            <div>S√£o Jo√£o</div>
                        </div>
                    </div>
                    
                    <div id="albumUploadSection" style="display: none;">
                        <h4 id="albumUploadTitle">Upload - √Ålbum</h4>
                        <input type="file" class="file-input" id="albumUpload" accept=".mp3" multiple>
                        <button class="btn" onclick="uploadAlbumFiles()">Upload √Ålbum</button>
                        <div class="file-list" id="albumList"></div>
                    </div>
                </div>

                <div class="admin-section">
                    <h3>üìä Relat√≥rio de Reprodu√ß√£o</h3>
                    <button class="btn" onclick="resetPlayStats()">üîÑ Reset Contagem</button>
                    <div id="playStats"></div>
                </div>
            </div>
        </div>
    </div>

    <audio id="audioPlayer" preload="auto"></audio>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/supabase-js/2.38.4/umd/supabase.min.js"></script>
    <script>
        // Configura√ß√µes do Supabase
        const SUPABASE_URL = 'https://yrlwyyvlgrjbwnoiwdxv.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlybHd5dnZsZ3JqYndub2l3ZHh2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg4MDk0OTMsImV4cCI6MjA2NDM4NTQ5M30.qrNDx8aqL2WtWPalhmjzeUY6bCNVnnK48L2Oi2DpkVI';
        const ADMIN_PASSWORD = 'admin123';

        // Inicializa cliente Supabase
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Estado da aplica√ß√£o
        let currentPlaylist = [];
        let currentTrackIndex = 0;
        let isPlaying = false;
        let audioPlayer = document.getElementById('audioPlayer');
        let musicCount = 0;
        let playStats = JSON.parse(localStorage.getItem('playStats') || '{}');
        let currentAlbumActive = localStorage.getItem('activeAlbum') || 'none';

        // Dados da r√°dio (carregados do Supabase)
        let radioData = {
            music: [],
            time: [],
            ads: [],
            albums: {
                natal: [],
                pascoa: [],
                saojoao: []
            }
        };

        // Configura√ß√£o inicial
        document.addEventListener('DOMContentLoaded', async function() {
            await loadSupabaseData();
            initializePlayer();
            loadTheme();
            setupVolumeControl();
            updateStats();
            setActiveAlbum(currentAlbumActive);
        });

        // Carrega dados do Supabase
        async function loadSupabaseData() {
            try {
                // Carrega m√∫sicas principais
                const { data: musicFiles } = await supabase.storage
                    .from('radio-music')
                    .list('', { limit: 100 });
                
                if (musicFiles) {
                    radioData.music = musicFiles
                        .filter(file => file.name.endsWith('.mp3'))
                        .map(file => ({
                            name: file.name,
                            url: getPublicUrl('radio-music', file.name)
                        }));
                }

                // Carrega hora certa
                const { data: timeFiles } = await supabase.storage
                    .from('radio-time')
                    .list('', { limit: 100 });
                
                if (timeFiles) {
                    radioData.time = timeFiles
                        .filter(file => file.name.endsWith('.mp3'))
                        .map(file => ({
                            name: file.name,
                            url: getPublicUrl('radio-time', file.name)
                        }));
                }

                // Carrega avisos
                const { data: adFiles } = await supabase.storage
                    .from('radio-ads')
                    .list('', { limit: 100 });
                
                if (adFiles) {
                    radioData.ads = adFiles
                        .filter(file => file.name.endsWith('.mp3'))
                        .map(file => ({
                            name: file.name,
                            url: getPublicUrl('radio-ads', file.name)
                        }));
                }

                // Carrega √°lbuns
                const albums = ['natal', 'pascoa', 'saojoao'];
                for (const album of albums) {
                    const { data: albumFiles } = await supabase.storage
                        .from('radio-albums')
                        .list(album, { limit: 100 });
                    
                    if (albumFiles) {
                        radioData.albums[album] = albumFiles
                            .filter(file => file.name.endsWith('.mp3'))
                            .map(file => ({
                                name: file.name,
                                url: getPublicUrl('radio-albums', `${album}/${file.name}`)
                            }));
                    }
                }

                console.log('‚úÖ Dados carregados do Supabase:', radioData);
            } catch (error) {
                console.error('‚ùå Erro ao carregar dados do Supabase:', error);
                // Fallback para dados de exemplo se falhar
                radioData = {
                    music: [{ name: 'M√∫sica Exemplo.mp3', url: '#' }],
                    time: [{ name: 'Hora Certa.mp3', url: '#' }],
                    ads: [{ name: 'Aviso.mp3', url: '#' }],
                    albums: {
                        natal: [],
                        pascoa: [],
                        saojoao: []
                    }
                };
            }
        }

        // Fun√ß√£o para obter URL p√∫blica
        function getPublicUrl(bucket, path) {
            const { data } = supabase.storage
                .from(bucket)
                .getPublicUrl(path);
            
            return data.publicUrl;
        }

        function initializePlayer() {
            generatePlaylist();
            
            audioPlayer.addEventListener('ended', function() {
                nextTrack();
            });

            audioPlayer.addEventListener('error', function() {
                console.log('Erro ao carregar √°udio, pulando para pr√≥xima');
                nextTrack();
            });

            // Atualizar interface
            updateNowPlaying();
        }

        function generatePlaylist() {
            currentPlaylist = [];
            let musicIndex = 0;
            
            // Algoritmo de intercala√ß√£o: 3 m√∫sicas -> hora certa -> 3 m√∫sicas -> aviso -> repetir
            while (musicIndex < radioData.music.length * 3) {
                // Adiciona 3 m√∫sicas
                for (let i = 0; i < 3 && musicIndex < radioData.music.length * 3; i++) {
                    const albumSongs = getActiveAlbumSongs();
                    if (albumSongs.length > 0) {
                        currentPlaylist.push({
                            type: 'album',
                            data: albumSongs[musicIndex % albumSongs.length]
                        });
                    } else {
                        currentPlaylist.push({
                            type: 'music',
                            data: radioData.music[musicIndex % radioData.music.length]
                        });
                    }
                    musicIndex++;
                }
                
                // Adiciona hora certa
                if (radioData.time.length > 0) {
                    currentPlaylist.push({
                        type: 'time',
                        data: radioData.time[Math.floor(Math.random() * radioData.time.length)]
                    });
                }
                
                // Adiciona 3 mais m√∫sicas
                for (let i = 0; i < 3 && musicIndex < radioData.music.length * 3; i++) {
                    const albumSongs = getActiveAlbumSongs();
                    if (albumSongs.length > 0) {
                        currentPlaylist.push({
                            type: 'album',
                            data: albumSongs[musicIndex % albumSongs.length]
                        });
                    } else {
                        currentPlaylist.push({
                            type: 'music',
                            data: radioData.music[musicIndex % radioData.music.length]
                        });
                    }
                    musicIndex++;
                }
                
                // Adiciona aviso
                if (radioData.ads.length > 0) {
                    currentPlaylist.push({
                        type: 'ads',
                        data: radioData.ads[Math.floor(Math.random() * radioData.ads.length)]
                    });
                }
            }
        }

        function getActiveAlbumSongs() {
            if (currentAlbumActive === 'none') return [];
            return radioData.albums[currentAlbumActive] || [];
        }

        function togglePlay() {
            const playBtn = document.getElementById('playBtn');
            
            if (isPlaying) {
                audioPlayer.pause();
                playBtn.innerHTML = '‚ñ∂Ô∏è';
                isPlaying = false;
            } else {
                if (currentPlaylist.length === 0) {
                    generatePlaylist();
                }
                
                // Como estamos em demo, simula reprodu√ß√£o
                playBtn.innerHTML = '‚è∏Ô∏è';
                isPlaying = true;
                updateNowPlaying();
                
                // Simula pr√≥xima m√∫sica ap√≥s 30 segundos (para demo)
                setTimeout(() => {
                    if (isPlaying) nextTrack();
                }, 30000);
            }
        }

        function nextTrack() {
            if (currentPlaylist.length === 0) return;
            
            currentTrackIndex = (currentTrackIndex + 1) % currentPlaylist.length;
            
            // Registra estat√≠stica
            const currentTrack = currentPlaylist[currentTrackIndex];
            const trackName = currentTrack.data.name;
            playStats[trackName] = (playStats[trackName] || 0) + 1;
            localStorage.setItem('playStats', JSON.stringify(playStats));
            
            updateNowPlaying();
            updateStats();
            
            if (isPlaying) {
                // Em produ√ß√£o, carregaria o √°udio real
                // audioPlayer.src = currentTrack.data.url;
                // audioPlayer.play();
                
                // Para demo, simula pr√≥xima ap√≥s 30s
                setTimeout(() => {
                    if (isPlaying) nextTrack();
                }, 30000);
            }
        }

        function updateNowPlaying() {
            const trackTitle = document.getElementById('trackTitle');
            const trackInfo = document.getElementById('trackInfo');
            
            if (currentPlaylist.length === 0) {
                trackTitle.textContent = 'Nenhuma m√∫sica';
                trackInfo.textContent = 'Carregue m√∫sicas no painel admin';
                return;
            }
            
            const currentTrack = currentPlaylist[currentTrackIndex];
            const typeLabels = {
                music: 'üéµ M√∫sica',
                time: 'üïê Hora Certa',
                ads: 'üì¢ Aviso',
                album: 'üé≠ √Ålbum'
            };
            
            trackTitle.textContent = currentTrack.data.name.replace('.mp3', '');
            trackInfo.textContent = typeLabels[currentTrack.type];
        }

        function setupVolumeControl() {
            const volumeSlider = document.getElementById('volumeSlider');
            const volumeDisplay = document.getElementById('volumeDisplay');
            
            volumeSlider.addEventListener('input', function() {
                const volume = this.value;
                volumeDisplay.textContent = volume + '%';
                audioPlayer.volume = volume / 100;
                localStorage.setItem('volume', volume);
            });
            
            // Carrega volume salvo
            const savedVolume = localStorage.getItem('volume') || 70;
            volumeSlider.value = savedVolume;
            volumeDisplay.textContent = savedVolume + '%';
            audioPlayer.volume = savedVolume / 100;
        }

        function toggleTheme() {
            document.body.classList.toggle('dark');
            const isDark = document.body.classList.contains('dark');
            localStorage.setItem('darkTheme', isDark);
        }

        function loadTheme() {
            const isDark = localStorage.getItem('darkTheme') === 'true';
            if (isDark) {
                document.body.classList.add('dark');
            }
        }

        // Fun√ß√µes do painel administrativo
        function openAdminModal() {
            document.getElementById('adminModal').style.display = 'flex';
        }

        function closeAdminModal() {
            document.getElementById('adminModal').style.display = 'none';
        }

        function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            if (password === ADMIN_PASSWORD) {
                document.getElementById('loginSection').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                loadAdminData();
            } else {
                alert('Senha incorreta!');
            }
        }

        function loadAdminData() {
            updateFileLists();
            updateStats();
            updatePlayStatsDisplay();
        }

        function updateFileLists() {
            const lists = {
                musicList: sampleData.music,
                timeList: sampleData.time,
                adsList: sampleData.ads
            };
            
            Object.keys(lists).forEach(listId => {
                const container = document.getElementById(listId);
                container.innerHTML = lists[listId].map(file => `
                    <div class="file-item">
                        <span>${file.name}</span>
                        <button class="delete-btn" onclick="deleteFile('${listId}', '${file.name}')">üóëÔ∏è</button>
                    </div>
                `).join('');
            });
            
            // Atualizar lista do √°lbum ativo
            if (currentAlbumActive !== 'none') {
                const albumList = document.getElementById('albumList');
                const albumFiles = sampleData.albums[currentAlbumActive] || [];
                albumList.innerHTML = albumFiles.map(file => `
                    <div class="file-item">
                        <span>${file.name}</span>
                        <button class="delete-btn" onclick="deleteAlbumFile('${file.name}')">üóëÔ∏è</button>
                    </div>
                `).join('');
            }
        }

        function updateStats() {
            document.getElementById('totalSongs').textContent = sampleData.music.length;
            document.getElementById('totalPlayed').textContent = Object.values(playStats).reduce((a, b) => a + b, 0);
            document.getElementById('currentAlbum').textContent = currentAlbumActive === 'none' ? 'Nenhum' : currentAlbumActive;
        }

        function updatePlayStatsDisplay() {
            const container = document.getElementById('playStats');
            const stats = Object.entries(playStats)
                .sort((a, b) => b[1] - a[1])
                .map(([name, count]) => `
                    <div class="file-item">
                        <span>${name}</span>
                        <span>${count}x</span>
                    </div>
                `).join('');
            
            container.innerHTML = stats || '<p>Nenhuma reprodu√ß√£o registrada ainda.</p>';
        }

        function selectAlbum(album) {
            // Remove classe ativa de todos
            document.querySelectorAll('.album-option').forEach(option => {
                option.classList.remove('active');
            });
            
            // Adiciona classe ativa ao selecionado
            document.querySelector(`[data-album="${album}"]`).classList.add('active');
            
            currentAlbumActive = album;
            localStorage.setItem('activeAlbum', album);
            
            // Mostra/esconde se√ß√£o de upload
            const uploadSection = document.getElementById('albumUploadSection');
            const uploadTitle = document.getElementById('albumUploadTitle');
            
            if (album === 'none') {
                uploadSection.style.display = 'none';
            } else {
                uploadSection.style.display = 'block';
                uploadTitle.textContent = `Upload - ${album.charAt(0).toUpperCase() + album.slice(1)}`;
                updateFileLists();
            }
            
            // Atualiza capa do √°lbum
            setActiveAlbum(album);
            
            // Regenera playlist
            generatePlaylist();
            updateStats();
        }

        function setActiveAlbum(album) {
            const albumCover = document.getElementById('albumCover');
            const albumCovers = {
                none: 'üéµ',
                natal: 'üéÑ',
                pascoa: 'üê∞',
                saojoao: 'üåΩ'
            };
            
            albumCover.innerHTML = albumCovers[album] || 'üéµ';
            
            // Marca op√ß√£o como ativa no admin
            document.querySelectorAll('.album-option').forEach(option => {
                option.classList.remove('active');
            });
            
            const activeOption = document.querySelector(`[data-album="${album}"]`);
            if (activeOption) {
                activeOption.classList.add('active');
            }
        }

        function resetPlayStats() {
            if (confirm('Tem certeza que deseja resetar todas as estat√≠sticas?')) {
                playStats = {};
                localStorage.removeItem('playStats');
                updatePlayStatsDisplay();
                updateStats();
            }
        }

        // Fun√ß√µes de upload reais para Supabase
        async function uploadFiles(type) {
            const inputId = type + 'Upload';
            const fileInput = document.getElementById(inputId);
            const files = fileInput.files;
            
            if (files.length === 0) {
                alert('Selecione pelo menos um arquivo!');
                return;
            }
            
            const bucketName = `radio-${type}`;
            let uploadedCount = 0;
            
            try {
                for (const file of files) {
                    if (file.type === 'audio/mpeg' || file.name.endsWith('.mp3')) {
                        const { data, error } = await supabase.storage
                            .from(bucketName)
                            .upload(file.name, file, {
                                cacheControl: '3600',
                                upsert: true
                            });
                        
                        if (error) {
                            console.error(`Erro ao fazer upload de ${file.name}:`, error);
                        } else {
                            uploadedCount++;
                            console.log(`‚úÖ Upload realizado: ${file.name}`);
                        }
                    }
                }
                
                // Recarrega dados do Supabase
                await loadSupabaseData();
                
                // Limpa input
                fileInput.value = '';
                
                // Atualiza interface
                updateFileLists();
                generatePlaylist();
                updateStats();
                
                alert(`${uploadedCount} arquivo(s) enviado(s) com sucesso!`);
                
            } catch (error) {
                console.error('Erro durante upload:', error);
                alert('Erro ao fazer upload dos arquivos. Verifique o console para mais detalhes.');
            }
        }

        async function uploadAlbumFiles() {
            const fileInput = document.getElementById('albumUpload');
            const files = fileInput.files;
            
            if (files.length === 0) {
                alert('Selecione pelo menos um arquivo!');
                return;
            }
            
            if (currentAlbumActive === 'none') {
                alert('Selecione um √°lbum primeiro!');
                return;
            }
            
            let uploadedCount = 0;
            
            try {
                for (const file of files) {
                    if (file.type === 'audio/mpeg' || file.name.endsWith('.mp3')) {
                        const filePath = `${currentAlbumActive}/${file.name}`;
                        
                        const { data, error } = await supabase.storage
                            .from('radio-albums')
                            .upload(filePath, file, {
                                cacheControl: '3600',
                                upsert: true
                            });
                        
                        if (error) {
                            console.error(`Erro ao fazer upload de ${file.name}:`, error);
                        } else {
                            uploadedCount++;
                            console.log(`‚úÖ Upload de √°lbum realizado: ${file.name}`);
                        }
                    }
                }
                
                // Recarrega dados do Supabase
                await loadSupabaseData();
                
                // Limpa input
                fileInput.value = '';
                
                // Atualiza interface
                updateFileLists();
                generatePlaylist();
                updateStats();
                
                alert(`${uploadedCount} arquivo(s) do √°lbum enviado(s) com sucesso!`);
                
            } catch (error) {
                console.error('Erro durante upload do √°lbum:', error);
                alert('Erro ao fazer upload dos arquivos do √°lbum. Verifique o console para mais detalhes.');
            }
        }

        function deleteFile(listType, fileName) {
            if (confirm(`Tem certeza que deseja excluir "${fileName}"?`)) {
                const typeMap = {
                    musicList: 'music',
                    timeList: 'time',
                    adsList: 'ads'
                };
                
                const dataType = typeMap[listType];
                sampleData[dataType] = sampleData[dataType].filter(file => file.name !== fileName);
                
                // Remove das estat√≠sticas tamb√©m
                delete playStats[fileName];
                localStorage.setItem('playStats', JSON.stringify(playStats));
                
                updateFileLists();
                generatePlaylist();
                updateStats();
                updatePlayStatsDisplay();
                
                alert('Arquivo exclu√≠do com sucesso!');
            }
        }

        function deleteAlbumFile(fileName) {
            if (confirm(`Tem certeza que deseja excluir "${fileName}" do √°lbum ${currentAlbumActive}?`)) {
                sampleData.albums[currentAlbumActive] = sampleData.albums[currentAlbumActive].filter(file => file.name !== fileName);
                
                // Remove das estat√≠sticas tamb√©m
                delete playStats[fileName];
                localStorage.setItem('playStats', JSON.stringify(playStats));
                
                updateFileLists();
                generatePlaylist();
                updateStats();
                updatePlayStatsDisplay();
                
                alert('Arquivo do √°lbum exclu√≠do com sucesso!');
            }
        }

        // Integra√ß√£o com Supabase (para implementar em produ√ß√£o)
        /*
        async function initSupabase() {
            // Inicializar cliente Supabase
            const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            
            // Fun√ß√µes para integra√ß√£o real:
            
            // 1. Upload de arquivo
            async function uploadToSupabase(file, bucket, path) {
                const { data, error } = await supabase.storage
                    .from(bucket)
                    .upload(path, file);
                
                if (error) throw error;
                return data;
            }
            
            // 2. Listar arquivos
            async function listFiles(bucket, folder = '') {
                const { data, error } = await supabase.storage
                    .from(bucket)
                    .list(folder);
                
                if (error) throw error;
                return data;
            }
            
            // 3. Obter URL p√∫blica
            function getPublicUrl(bucket, path) {
                const { data } = supabase.storage
                    .from(bucket)
                    .getPublicUrl(path);
                
                return data.publicUrl;
            }
            
            // 4. Deletar arquivo
            async function deleteFromSupabase(bucket, path) {
                const { error } = await supabase.storage
                    .from(bucket)
                    .remove([path]);
                
                if (error) throw error;
            }
        }
        */

        // Fun√ß√£o para carregar dados reais do Supabase (implementar em produ√ß√£o)
        async function loadSupabaseData() {
            // Substituir sampleData por dados reais do Supabase
            // const realData = await fetchFromSupabase();
            // sampleData = realData;
        }

        // Event listeners adicionais
        document.addEventListener('keydown', function(event) {
            // Controles por teclado
            if (event.code === 'Space' && !event.target.matches('input, textarea')) {
                event.preventDefault();
                togglePlay();
            }
            
            if (event.code === 'ArrowRight' && event.ctrlKey) {
                nextTrack();
            }
            
            if (event.code === 'ArrowUp' && event.ctrlKey) {
                const volumeSlider = document.getElementById('volumeSlider');
                volumeSlider.value = Math.min(100, parseInt(volumeSlider.value) + 10);
                volumeSlider.dispatchEvent(new Event('input'));
            }
            
            if (event.code === 'ArrowDown' && event.ctrlKey) {
                const volumeSlider = document.getElementById('volumeSlider');
                volumeSlider.value = Math.max(0, parseInt(volumeSlider.value) - 10);
                volumeSlider.dispatchEvent(new Event('input'));
            }
        });

        // Fechar modal clicando fora
        document.getElementById('adminModal').addEventListener('click', function(event) {
            if (event.target === this) {
                closeAdminModal();
            }
        });

        // Previne fechamento acidental durante upload
        window.addEventListener('beforeunload', function(event) {
            if (isPlaying) {
                event.preventDefault();
                event.returnValue = 'A r√°dio est√° tocando. Tem certeza que deseja sair?';
            }
        });

        // Auto-save de configura√ß√µes
        setInterval(function() {
            const config = {
                activeAlbum: currentAlbumActive,
                volume: document.getElementById('volumeSlider').value,
                theme: document.body.classList.contains('dark'),
                playStats: playStats
            };
            
            localStorage.setItem('radioConfig', JSON.stringify(config));
        }, 30000); // Salva a cada 30 segundos

        // Carrega configura√ß√µes salvas
        function loadSavedConfig() {
            const saved = localStorage.getItem('radioConfig');
            if (saved) {
                const config = JSON.parse(saved);
                
                if (config.activeAlbum) {
                    currentAlbumActive = config.activeAlbum;
                    setActiveAlbum(currentAlbumActive);
                }
                
                if (config.volume) {
                    const volumeSlider = document.getElementById('volumeSlider');
                    volumeSlider.value = config.volume;
                    volumeSlider.dispatchEvent(new Event('input'));
                }
                
                if (config.theme) {
                    document.body.classList.toggle('dark', config.theme);
                }
                
                if (config.playStats) {
                    playStats = config.playStats;
                }
            }
        }

        // Inicializa configura√ß√µes salvas quando carrega a p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            loadSavedConfig();
        });

        // Fun√ß√£o para debug (remover em produ√ß√£o)
        function debugInfo() {
            console.log('Estado atual da r√°dio:', {
                isPlaying: isPlaying,
                currentTrackIndex: currentTrackIndex,
                playlistLength: currentPlaylist.length,
                currentTrack: currentPlaylist[currentTrackIndex],
                activeAlbum: currentAlbumActive,
                totalStats: Object.values(playStats).reduce((a, b) => a + b, 0)
            });
        }

        // Adiciona fun√ß√£o de debug ao escopo global (remover em produ√ß√£o)
        window.debugRadio = debugInfo;

        console.log('üéµ R√°dio Supermercado do Louro inicializada!');
        console.log('üí° Dica: Use "debugRadio()" no console para ver informa√ß√µes de debug');
        console.log('‚å®Ô∏è Controles: Espa√ßo = Play/Pause, Ctrl+‚Üí = Pr√≥xima, Ctrl+‚Üë/‚Üì = Volume');
    </script>
</body>
</html>
