<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R√°dio Supermercado do Louro</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#0d4f3c,#1a6b54,#2d8659);color:#fff;min-height:100vh;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden}
        body::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:radial-gradient(circle at 20% 20%,rgba(255,255,255,0.1) 0%,transparent 50%),radial-gradient(circle at 80% 80%,rgba(255,255,255,0.05) 0%,transparent 50%);pointer-events:none}
        .container{background:rgba(255,255,255,0.98);color:#0d4f3c;backdrop-filter:blur(20px);border-radius:30px;padding:50px;box-shadow:0 30px 60px rgba(0,0,0,0.3),0 10px 30px rgba(0,0,0,0.1),inset 0 1px 0 rgba(255,255,255,0.8);max-width:450px;width:90%;text-align:center;animation:fadeInUp 1s ease-out;position:relative;border:1px solid rgba(255,255,255,0.2)}
        @keyframes fadeInUp{from{opacity:0;transform:translateY(50px)}to{opacity:1;transform:translateY(0)}}
        .logo{font-size:2.8rem;font-weight:900;margin-bottom:8px;background:linear-gradient(135deg,#0d4f3c,#2d8659);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;text-shadow:0 2px 4px rgba(0,0,0,0.1);letter-spacing:-1px}
        .subtitle{opacity:0.7;margin-bottom:40px;font-size:1.2rem;color:#1a6b54;font-weight:500;letter-spacing:1px}
        .album-cover{width:220px;height:220px;border-radius:50%;margin:0 auto 30px;background:linear-gradient(135deg,#0d4f3c,#1a6b54,#2d8659);display:flex;align-items:center;justify-content:center;font-size:4rem;color:#fff;box-shadow:0 20px 40px rgba(13,79,60,0.4),0 10px 20px rgba(13,79,60,0.2),inset 0 2px 4px rgba(255,255,255,0.1);transition:all 0.4s cubic-bezier(0.175,0.885,0.32,1.275);position:relative;overflow:hidden}
        .album-cover::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:radial-gradient(circle at center,transparent 40%,rgba(255,255,255,0.1) 100%);pointer-events:none}
        .album-cover:hover{transform:scale(1.05) rotate(5deg);box-shadow:0 25px 50px rgba(13,79,60,0.5),0 15px 30px rgba(13,79,60,0.3)}
        .album-cover.playing{animation:pulse 2s ease-in-out infinite}
        @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.02)}}
        .track-info{margin:30px 0;padding:20px;background:rgba(13,79,60,0.05);border-radius:20px;border:1px solid rgba(13,79,60,0.1)}
        .track-title{font-size:1.4rem;font-weight:700;margin-bottom:8px;color:#0d4f3c;line-height:1.3}
        .track-artist{opacity:0.8;font-size:1.1rem;color:#1a6b54;font-weight:500}
        .controls{display:flex;align-items:center;justify-content:center;gap:30px;margin:40px 0}
        .play-btn{width:80px;height:80px;border:none;border-radius:50%;background:linear-gradient(135deg,#0d4f3c,#2d8659);color:#fff;font-size:2rem;cursor:pointer;transition:all 0.3s cubic-bezier(0.175,0.885,0.32,1.275);box-shadow:0 15px 30px rgba(13,79,60,0.4),0 5px 15px rgba(13,79,60,0.2);position:relative;overflow:hidden}
        .play-btn::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,transparent,rgba(255,255,255,0.2));pointer-events:none}
        .play-btn:hover{transform:scale(1.1);box-shadow:0 20px 40px rgba(13,79,60,0.5),0 10px 20px rgba(13,79,60,0.3)}
        .play-btn:active{transform:scale(1.05)}
        .volume-control{display:flex;align-items:center;gap:15px;color:#0d4f3c;background:rgba(13,79,60,0.05);padding:15px 20px;border-radius:25px;border:1px solid rgba(13,79,60,0.1)}
        .volume-slider{width:120px;height:8px;border-radius:4px;background:rgba(13,79,60,0.2);outline:none;cursor:pointer;-webkit-appearance:none}
        .volume-slider::-webkit-slider-thumb{-webkit-appearance:none;width:24px;height:24px;border-radius:50%;background:linear-gradient(135deg,#0d4f3c,#2d8659);cursor:pointer;box-shadow:0 4px 8px rgba(13,79,60,0.3);transition:all 0.2s ease}
        .volume-slider::-webkit-slider-thumb:hover{transform:scale(1.2);box-shadow:0 6px 12px rgba(13,79,60,0.4)}
        .admin-toggle{position:absolute;top:30px;right:30px;background:rgba(255,255,255,0.95);border:none;color:#0d4f3c;padding:12px 18px;border-radius:25px;cursor:pointer;font-size:1rem;transition:all 0.3s ease;box-shadow:0 8px 16px rgba(0,0,0,0.1);border:1px solid rgba(13,79,60,0.1)}
        .admin-toggle:hover{background:#fff;box-shadow:0 12px 24px rgba(0,0,0,0.15);transform:translateY(-2px)}
        .admin-panel{display:none;background:rgba(0,0,0,0.95);position:fixed;top:0;left:0;width:100%;height:100%;z-index:1000;overflow-y:auto;padding:20px}
        .admin-content{background:rgba(255,255,255,0.98);color:#0d4f3c;backdrop-filter:blur(20px);border-radius:25px;padding:40px;max-width:900px;margin:0 auto;box-shadow:0 25px 50px rgba(0,0,0,0.3)}
        .admin-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:40px}
        .close-admin{background:linear-gradient(135deg,#d32f2f,#f44336);border:none;color:#fff;padding:12px 24px;border-radius:15px;cursor:pointer;font-size:1rem;transition:all 0.3s ease}
        .upload-section{background:rgba(13,79,60,0.05);border:2px solid rgba(13,79,60,0.1);border-radius:20px;padding:25px;margin-bottom:25px}
        .upload-section h3{margin-bottom:20px;color:#0d4f3c;font-size:1.3rem}
        .file-input{width:100%;padding:15px;border:2px dashed rgba(13,79,60,0.3);border-radius:15px;background:rgba(13,79,60,0.05);color:#0d4f3c;margin-bottom:15px;cursor:pointer;transition:all 0.3s ease}
        .file-input:hover{border-color:rgba(13,79,60,0.5);background:rgba(13,79,60,0.08)}
        .upload-btn{background:linear-gradient(135deg,#0d4f3c,#2d8659);border:none;color:#fff;padding:15px 25px;border-radius:15px;cursor:pointer;font-size:1rem;width:100%;transition:all 0.3s ease;box-shadow:0 8px 16px rgba(13,79,60,0.2)}
        .upload-btn:hover{transform:translateY(-2px);box-shadow:0 12px 24px rgba(13,79,60,0.3)}
        .album-control{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:20px;margin-top:25px}
        .album-item{background:rgba(13,79,60,0.05);border:2px solid rgba(13,79,60,0.2);border-radius:15px;padding:20px;text-align:center;cursor:pointer;transition:all 0.3s ease;color:#0d4f3c;font-weight:600}
        .album-item:hover{background:rgba(13,79,60,0.1);transform:translateY(-3px);box-shadow:0 8px 16px rgba(13,79,60,0.1)}
        .album-item.active{background:linear-gradient(135deg,#0d4f3c,#2d8659);color:#fff;border-color:#0d4f3c;box-shadow:0 8px 16px rgba(13,79,60,0.3)}
        .stats{background:rgba(13,79,60,0.05);border:2px solid rgba(13,79,60,0.1);border-radius:20px;padding:25px;margin-top:25px}
        .stats h3{color:#0d4f3c;margin-bottom:20px;font-size:1.3rem}
        .stat-item{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid rgba(13,79,60,0.1);color:#1a6b54}
        .login-form{background:rgba(255,255,255,0.98);color:#0d4f3c;border-radius:20px;padding:40px;margin:20px;max-width:450px;margin:0 auto;box-shadow:0 25px 50px rgba(0,0,0,0.3)}
        .login-input{width:100%;padding:18px;border:2px solid rgba(13,79,60,0.2);border-radius:15px;background:rgba(13,79,60,0.05);color:#0d4f3c;font-size:1.1rem;margin-bottom:25px;transition:all 0.3s ease}
        .login-input:focus{border-color:#0d4f3c;outline:none;box-shadow:0 0 0 3px rgba(13,79,60,0.1)}
        .login-input::placeholder{color:rgba(13,79,60,0.6)}
        .login-btn{width:100%;padding:18px;border:none;border-radius:15px;background:linear-gradient(135deg,#0d4f3c,#2d8659);color:#fff;font-size:1.1rem;cursor:pointer;transition:all 0.3s ease;box-shadow:0 8px 16px rgba(13,79,60,0.2)}
        .login-btn:hover{transform:translateY(-2px);box-shadow:0 12px 24px rgba(13,79,60,0.3)}
        .progress-bar{width:100%;height:6px;background:rgba(13,79,60,0.2);border-radius:3px;margin:25px 0;overflow:hidden;box-shadow:inset 0 2px 4px rgba(0,0,0,0.1)}
        .progress-fill{height:100%;background:linear-gradient(90deg,#0d4f3c,#2d8659);width:0%;transition:width 0.3s ease;border-radius:3px}
        .file-list{max-height:220px;overflow-y:auto;background:rgba(13,79,60,0.05);border-radius:15px;padding:15px;margin-top:15px}
        .file-item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-bottom:1px solid rgba(13,79,60,0.1);color:#1a6b54}
        .delete-btn{background:linear-gradient(135deg,#d32f2f,#f44336);border:none;color:#fff;padding:8px 12px;border-radius:8px;cursor:pointer;font-size:0.9rem;transition:all 0.3s ease}
        .delete-btn:hover{transform:translateY(-1px);box-shadow:0 4px 8px rgba(211,47,47,0.3)}
        @media (max-width:768px){.container{padding:30px;margin:15px}.admin-content{padding:25px;margin:10px}.album-control{grid-template-columns:1fr 1fr}.controls{gap:20px}.play-btn{width:70px;height:70px;font-size:1.8rem}.volume-control{padding:12px 16px}.volume-slider{width:100px}}
        @media (max-width:480px){.logo{font-size:2.2rem}.album-cover{width:180px;height:180px;font-size:3rem}.track-title{font-size:1.2rem}.track-artist{font-size:1rem}}
    </style>
</head>
<body>
    <button class="admin-toggle" onclick="toggleAdmin()">‚öôÔ∏è Admin</button>
    <div class="container" id="playerContainer">
        <div class="logo">üéµ R√°dio Supermercado</div>
        <div class="subtitle">do Louro</div>
        <div class="album-cover" id="albumCover">üéµ</div>
        <div class="track-info">
            <div class="track-title" id="trackTitle">Carregando...</div>
            <div class="track-artist" id="trackArtist">Prepare-se para uma experi√™ncia √∫nica</div>
        </div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="controls">
            <button class="play-btn" id="playBtn" onclick="togglePlayPause()">‚ñ∂Ô∏è</button>
            <div class="volume-control">
                <span style="font-size:1.2rem">üîä</span>
                <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="70">
            </div>
        </div>
    </div>

    <div class="admin-panel" id="adminPanel">
        <div id="loginForm" class="login-form">
            <h2 style="text-align:center;margin-bottom:25px;color:#0d4f3c;font-size:1.8rem">üîê Acesso Administrativo</h2>
            <input type="password" class="login-input" id="adminPassword" placeholder="Digite a senha">
            <button class="login-btn" onclick="adminLogin()">Entrar</button>
        </div>
        <div id="adminContent" class="admin-content" style="display:none">
            <div class="admin-header">
                <h2 style="color:#0d4f3c;font-size:1.8rem">üõ†Ô∏è Painel Administrativo</h2>
                <button class="close-admin" onclick="closeAdmin()">‚úï Fechar</button>
            </div>
            <div class="upload-section">
                <h3>üéµ Upload de M√∫sicas</h3>
                <input type="file" class="file-input" id="musicUpload" accept=".mp3" multiple>
                <button class="upload-btn" onclick="uploadFiles('music')">Upload M√∫sicas</button>
                <div class="file-list" id="musicList"></div>
            </div>
            <div class="upload-section">
                <h3>üïê Upload Hora Certa</h3>
                <input type="file" class="file-input" id="timeUpload" accept=".mp3" multiple>
                <button class="upload-btn" onclick="uploadFiles('time')">Upload Hora Certa</button>
                <div class="file-list" id="timeList"></div>
            </div>
            <div class="upload-section">
                <h3>üì¢ Upload Avisos</h3>
                <input type="file" class="file-input" id="adUpload" accept=".mp3" multiple>
                <button class="upload-btn" onclick="uploadFiles('ads')">Upload Avisos</button>
                <div class="file-list" id="adsList"></div>
            </div>
            <div class="upload-section">
                <h3>üéä √Ålbuns Tem√°ticos</h3>
                <div class="album-control">
                    <div class="album-item" data-album="natal" onclick="setActiveAlbum('natal')">üéÑ Natal</div>
                    <div class="album-item" data-album="pascoa" onclick="setActiveAlbum('pascoa')">üê∞ P√°scoa</div>
                    <div class="album-item" data-album="saojoao" onclick="setActiveAlbum('saojoao')">üé™ S√£o Jo√£o</div>
                    <div class="album-item" data-album="none" onclick="setActiveAlbum('none')">‚ùå Desativar</div>
                </div>
                <input type="file" class="file-input" id="albumUpload" accept=".mp3" multiple style="margin-top:20px">
                <button class="upload-btn" onclick="uploadAlbumFiles()">Upload √Ålbum Ativo</button>
                <div class="file-list" id="albumList"></div>
            </div>
            <div class="stats">
                <h3>üìä Estat√≠sticas</h3>
                <div id="playStats"></div>
                <button class="upload-btn" onclick="resetStats()" style="margin-top:20px;background:linear-gradient(135deg,#d32f2f,#f44336)">üóëÔ∏è Reset</button>
            </div>
            <div class="upload-section">
                <h3>üíæ Backup</h3>
                <button class="upload-btn" onclick="exportConfig()" style="margin-bottom:15px">üì§ Exportar</button>
                <input type="file" id="importConfig" accept=".json" onchange="importConfig(event)" style="display:none">
                <button class="upload-btn" onclick="document.getElementById('importConfig').click()">üì• Importar</button>
            </div>
        </div>
    </div>
    <audio id="audioPlayer" preload="auto"></audio>

    <script>
        const CLOUDINARY_CONFIG={cloudName:'dygbrcrr6',uploadPreset:'radio_preset',apiKey:'your_api_key'};
        let currentPlaylist=[],currentIndex=0,isPlaying=false,musicCount=0,activeAlbum=localStorage.getItem('activeAlbum')||'none';
        let audioFiles={music:JSON.parse(localStorage.getItem('musicFiles')||'[]'),time:JSON.parse(localStorage.getItem('timeFiles')||'[]'),ads:JSON.parse(localStorage.getItem('adsFiles')||'[]'),albums:{natal:JSON.parse(localStorage.getItem('natalFiles')||'[]'),pascoa:JSON.parse(localStorage.getItem('pascoaFiles')||'[]'),saojoao:JSON.parse(localStorage.getItem('saojoaoFiles')||'[]')}};
        let playStats=JSON.parse(localStorage.getItem('playStats')||'{}');
        const audioPlayer=document.getElementById('audioPlayer'),playBtn=document.getElementById('playBtn'),volumeSlider=document.getElementById('volumeSlider'),trackTitle=document.getElementById('trackTitle'),trackArtist=document.getElementById('trackArtist'),albumCover=document.getElementById('albumCover'),progressFill=document.getElementById('progressFill');

        window.addEventListener('load',()=>{setupAudioPlayer();generatePlaylist();updateUI();updateAlbumDisplay();updateFileList();updatePlayStats()});

        function setupAudioPlayer(){
            audioPlayer.volume=volumeSlider.value/100;
            volumeSlider.addEventListener('input',e=>audioPlayer.volume=e.target.value/100);
            audioPlayer.addEventListener('loadedmetadata',updateUI);
            audioPlayer.addEventListener('timeupdate',()=>{if(audioPlayer.duration)progressFill.style.width=(audioPlayer.currentTime/audioPlayer.duration)*100+'%'});
            audioPlayer.addEventListener('ended',nextTrack);
            audioPlayer.addEventListener('error',e=>{console.log('Erro:',e);nextTrack()});
            audioPlayer.addEventListener('play',()=>albumCover.classList.add('playing'));
            audioPlayer.addEventListener('pause',()=>albumCover.classList.remove('playing'));
        }

        function generatePlaylist(){
            currentPlaylist=[];
            const musicFiles=audioFiles.music,albumFiles=activeAlbum!=='none'?audioFiles.albums[activeAlbum]:[],allMusic=[...musicFiles,...albumFiles];
            if(allMusic.length===0){currentPlaylist=[{type:'music',title:'M√∫sica de Exemplo',artist:'Artista Exemplo',url:'https://res.cloudinary.com/dygbrcrr6/video/upload/v1749781508/Leonardo-Nao-Aprendi-A-Dizer-Adeus_xrmdjf.mp3'}];return}
            const shuffled=[...allMusic].sort(()=>Math.random()-0.5);
            for(let i=0;i<shuffled.length;i++){
                currentPlaylist.push({type:'music',title:shuffled[i].name||'M√∫sica',artist:'Supermercado do Louro',url:shuffled[i].url});
                if((i+1)%3===0&&audioFiles.time.length>0){const timeFile=audioFiles.time[Math.floor(Math.random()*audioFiles.time.length)];currentPlaylist.push({type:'time',title:'Hora Certa',artist:'Informativo',url:timeFile.url})}
                if((i+1)%6===0&&audioFiles.ads.length>0){const adFile=audioFiles.ads[Math.floor(Math.random()*audioFiles.ads.length)];currentPlaylist.push({type:'ads',title:'Aviso Importante',artist:'Administra√ß√£o',url:adFile.url})}
            }
        }

        function togglePlayPause(){
            if(isPlaying){audioPlayer.pause();playBtn.textContent='‚ñ∂Ô∏è';isPlaying=false}else{if(currentPlaylist.length===0)generatePlaylist();if(currentIndex>=currentPlaylist.length)currentIndex=0;playCurrentTrack()}
        }

        function playCurrentTrack(){
            if(currentPlaylist.length===0)return;
            const track=currentPlaylist[currentIndex];
            audioPlayer.src=track.url;
            audioPlayer.play().then(()=>{isPlaying=true;playBtn.textContent='‚è∏Ô∏è';updateUI();updatePlayStats(track)}).catch(e=>{console.log('Erro:',e);nextTrack()})
        }

        function nextTrack(){currentIndex++;if(currentIndex>=currentPlaylist.length){generatePlaylist();currentIndex=0}playCurrentTrack()}

        function updateUI(){
            if(currentPlaylist.length===0)return;
            const track=currentPlaylist[currentIndex];
            trackTitle.textContent=track.title;trackArtist.textContent=track.artist;
            if(track.type==='time'){albumCover.style.background='linear-gradient(135deg,#ff8f00,#ffa726,#ffb74d)';albumCover.textContent='üïê'}
            else if(track.type==='ads'){albumCover.style.background='linear-gradient(135deg,#d32f2f,#f44336,#e57373)';albumCover.textContent='üì¢'}
            else{albumCover.style.background='linear-gradient(135deg,#0d4f3c,#1a6b54,#2d8659)';albumCover.textContent='üéµ'}
        }

        function updateAlbumDisplay(){document.querySelectorAll('.album-item').forEach(item=>{item.classList.remove('active');if(item.dataset.album===activeAlbum)item.classList.add('active')})}

        function updatePlayStats(track){
            if(track&&track.type==='music'){const key=track.title+' - '+track.artist;playStats[key]=(playStats[key]||0)+1;localStorage.setItem('playStats',JSON.stringify(playStats));updatePlayStatsDisplay()}
        }

        function updatePlayStatsDisplay(){
            const statsContainer=document.getElementById('playStats');statsContainer.innerHTML='';
            Object.entries(playStats).sort(([,a],[,b])=>b-a).slice(0,10).forEach(([track,count])=>{
                const statItem=document.createElement('div');statItem.className='stat-item';statItem.innerHTML=`<span>${track}</span><span>${count}x</span>`;statsContainer.appendChild(statItem)
            })
        }

        function resetStats(){playStats={};localStorage.removeItem('playStats');updatePlayStatsDisplay()}

        function toggleAdmin(){document.getElementById('adminPanel').style.display='block'}
        function closeAdmin(){document.getElementById('adminPanel').style.display='none'}
        function adminLogin(){if(document.getElementById('adminPassword').value==='admin123'){document.getElementById('loginForm').style.display='none';document.getElementById('adminContent').style.display='block';updateFileList();updatePlayStatsDisplay()}else alert('Senha incorreta!')}

        function setActiveAlbum(album){activeAlbum=album;localStorage.setItem('activeAlbum',album);updateAlbumDisplay();generatePlaylist()}

        function uploadFiles(type){
            const fileInput=document.getElementById(type+'Upload'),files=fileInput.files;
            if(files.length===0){alert('Selecione arquivos');return}
            Array.from(files).forEach(file=>{const fileObj={name:file.name,url:URL.createObjectURL(file),uploadDate:new Date().toISOString()};audioFiles[type].push(fileObj)});
            localStorage.setItem(type+'Files',JSON.stringify(audioFiles[type]));updateFileList();generatePlaylist();fileInput.value='';alert('Arquivos enviados!')
        }

        function uploadAlbumFiles(){
            if(activeAlbum==='none'){alert('Selecione um √°lbum');return}
            const fileInput=document.getElementById('albumUpload'),files=fileInput.files;
            if(files.length===0){alert('Selecione arquivos');return}
            Array.from(files).forEach(file=>{const fileObj={name:file.name,url:URL.createObjectURL(file),uploadDate:new Date().toISOString()};audioFiles.albums[activeAlbum].push(fileObj)});
            localStorage.setItem(activeAlbum+'Files',JSON.stringify(audioFiles.albums[activeAlbum]));updateFileList();generatePlaylist();fileInput.value='';alert('Arquivos do √°lbum enviados!')
        }

        function updateFileList(){
            updateSingleFileList('music','musicList');updateSingleFileList('time','timeList');updateSingleFileList('ads','adsList');
            if(activeAlbum!=='none')updateAlbumFileList()
        }

        function updateSingleFileList(type,containerId){
            const container=document.getElementById(containerId);container.innerHTML='';
            audioFiles[type].forEach((file,index)=>{const fileItem=document.createElement('div');fileItem.className='file-item';fileItem.innerHTML=`<span>${file.name}</span><button class="delete-btn" onclick="deleteFile('${type}',${index})">üóëÔ∏è</button>`;container.appendChild(fileItem)})
        }

        function updateAlbumFileList(){
            const container=document.getElementById('albumList');container.innerHTML='';
            if(activeAlbum==='none')return;
            audioFiles.albums[activeAlbum].forEach((file,index)=>{const fileItem=document.createElement('div');fileItem.className='file-item';fileItem.innerHTML=`<span>${file.name}</span><button class="delete-btn" onclick="deleteAlbumFile(${index})">üóëÔ∏è</button>`;container.appendChild(fileItem)})
        }

        function deleteFile(type,index){
            if(confirm('Excluir arquivo?')){audioFiles[type].splice(index,1);localStorage.setItem(type+'Files',JSON.stringify(audioFiles[type]));updateFileList();generatePlaylist()}
        }

        function deleteAlbumFile(index){
            if(confirm('Excluir arquivo?')){audioFiles.albums[activeAlbum].splice(index,1);localStorage.setItem(activeAlbum+'Files',JSON.stringify(audioFiles.albums[activeAlbum]));updateFileList();generatePlaylist()}
        }

        async function uploadToCloudinary(file,folder='radio'){
            const formData=new FormData();formData.append('file',file);formData.append('upload_preset',CLOUDINARY_CONFIG.uploadPreset);formData.append('folder',folder);
            try{const response=await fetch(`https://api.cloudinary.com/v1_1/${CLOUDINARY_CONFIG.cloudName}/video/upload`,{method:'POST',body:formData});const data=await response.json();
            if(data.secure_url)return{name:file.name,url:data.secure_url,publicId:data.public_id,uploadDate:new Date().toISOString()};throw new Error('Upload falhou')}catch(error){console.error('Erro:',error);throw error}
        }

        function exportConfig(){
            const config={audioFiles,activeAlbum,playStats,timestamp:new Date().toISOString()};
            const dataStr=JSON.stringify(config,null,2),dataBlob=new Blob([dataStr],{type:'application/json'}),link=document.createElement('a');
            link.href=URL.createObjectURL(dataBlob);link.download='radio_config_backup.json';link.click()
        }

        function importConfig(event){
            const file=event.target.files[0];if(!file)return;
            const reader=new FileReader();reader.onload=function(e){
                try{const config=JSON.parse(e.target.result);audioFiles=config.audioFiles||audioFiles;activeAlbum=config.activeAlbum||'none';playStats=config.playStats||{};
                localStorage.setItem('musicFiles',JSON.stringify(audioFiles.music));localStorage.setItem('timeFiles',JSON.stringify(audioFiles.time));localStorage.setItem('adsFiles',JSON.stringify(audioFiles.ads));
                localStorage.setItem('natalFiles',JSON.stringify(audioFiles.albums.natal));localStorage.setItem('pascoaFiles',JSON.stringify(audioFiles.albums.pascoa));localStorage.setItem('saojoaoFiles',JSON.stringify(audioFiles.albums.saojoao));
                localStorage.setItem('activeAlbum',activeAlbum);localStorage.setItem('playStats',JSON.stringify(playStats));updateFileList();updateAlbumDisplay();updatePlayStatsDisplay();generatePlaylist();alert('Configura√ß√µes importadas!')}
                catch(error){alert('Erro ao importar: '+error.message)}};reader.readAsText(file)
        }

        setTimeout(()=>{if(currentPlaylist.length>0)playCurrentTrack()},2000);
        if('serviceWorker'in navigator)navigator.serviceWorker.register('/sw.js').catch(err=>console.log('SW error:',err));
        document.addEventListener('keydown',e=>{if(e.code==='Space'&&!document.getElementById('adminPanel').style.display){e.preventDefault();togglePlayPause()}});
        if('Notification'in window&&Notification.permission==='default')Notification.requestPermission();

        function createAudioVisualizer(){
            try{const audioContext=new(window.AudioContext||window.webkitAudioContext)(),analyser=audioContext.createAnalyser(),source=audioContext.createMediaElementSource(audioPlayer);
            source.connect(analyser);analyser.connect(audioContext.destination);analyser.fftSize=256;const bufferLength=analyser.frequencyBinCount,dataArray=new Uint8Array(bufferLength);
            function animate(){requestAnimationFrame(animate);analyser.getByteFrequencyData(dataArray);const average=dataArray.reduce((a,b)=>a+b)/bufferLength,intensity=average/255,scale=1+(intensity*0.1);albumCover.style.transform=`scale(${scale})`}animate()}
            catch(error){console.log('Visualizador erro:',error)}
        }
        audioPlayer.addEventListener('play',createAudioVisualizer,{once:true});
        console.log('üéµ R√°dio Supermercado do Louro - Sistema iniciado!');
